geom_line(data = Por_Yanbu_preddata, aes(x = temp, y = Median), color = 'darkorange1', show.legend = FALSE) +
geom_ribbon(data = Por_Yanbu_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkorange1', linetype=2, alpha = 0.2) +
geom_vline(data = Por_coeff_means, aes(xintercept = Por_Yanbu_coeff_mean), color = 'darkorange1', show.legend = FALSE) +
annotate("rect", xmin=Por_coeff_lowers$Por_Yanbu_coeff_lower, xmax=Por_coeff_uppers$Por_Yanbu_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkorange1',  alpha = 0.1) +
geom_text(data = Por_coeff_means, aes(label=round(Por_Yanbu_coeff_mean, digits = 2)), x = 31, y = 20, show.legend = FALSE, color = 'darkorange1') +
geom_line(data = Por_AlFahal_preddata, aes(x = temp, y = Median), color = 'red3', show.legend = FALSE) +
geom_ribbon(data = Por_AlFahal_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'red3', linetype=2, alpha = 0.2) +
geom_vline(data = Por_coeff_means, aes(xintercept = Por_AlFahal_coeff_mean), color = 'red3', show.legend = FALSE) +
annotate("rect", xmin=Por_coeff_lowers$Por_AlFahal_coeff_lower, xmax=Por_coeff_uppers$Por_AlFahal_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'red3',  alpha = 0.1) +
geom_text(data = Por_coeff_means, aes(label=round(Por_AlFahal_coeff_mean, digits = 2)), x = 31, y = 10, show.legend = FALSE, color = 'red3') +
geom_line(data = Por_Obock_preddata, aes(x = temp, y = Median), color = 'springgreen1', show.legend = FALSE) +
geom_ribbon(data = Por_Obock_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'springgreen1', linetype=2, alpha = 0.2) +
geom_vline(data = Por_coeff_means, aes(xintercept = Por_Obock_coeff_mean), color = 'springgreen1', show.legend = FALSE) +
annotate("rect", xmin=Por_coeff_lowers$Por_Obock_coeff_lower, xmax=Por_coeff_uppers$Por_Obock_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'springgreen1',  alpha = 0.1) +
geom_text(data = Por_coeff_means, aes(label=round(Por_Obock_coeff_mean, digits = 2)), x = 31, y = 0, show.legend = FALSE, color = 'springgreen1') +
ggtitle("Porites") +
scale_color_manual(values=c("darkgoldenrod1", "darkorange1", "red3", "darkorchid4", "springgreen1")) +
ylab("Percent pigmentation") +
xlab("Temperature (°C)") +
theme_bw()
Por_plot
Acr_Eilat_pop <- drm(Median ~ Temp, data = Acr_data[Acr_data$Site=="Eilat",], fct = LL.3())
summary(Acr_Eilat_pop)
plot(Acr_Eilat_pop)
Acr_Eilat <- drm(Median ~ Temp, data = Acr_data[Acr_data$Site=="Eilat",], curveid=Geno, fct = LL.3())
summary(Acr_Eilat)
plot(Acr_Eilat)
Acr_Eilat_pop <- drm(Median ~ Temp, data = Acr_data[Acr_data$Site=="Eilat",], fct = LL.3())
summary(Acr_Eilat_pop)
plot(Acr_Eilat_pop)
Acr_Eilat <- drm(Median ~ Temp, data = Acr_data[Acr_data$Site=="Eilat",], curveid=Geno, fct = LL.3())
summary(Acr_Eilat)
plot(Acr_Eilat)
plot(Acr_Eilat_pop)
summary(Acr_Eilat_pop)
Acr_AlWajh_pop <- drm(Median ~ Temp, data = Acr_data[Acr_data$Site=="AlWajh",], fct = LL.3())
summary(Acr_AlWajh_pop)
plot(Acr_AlWajh_pop)
Acr_AlWajh <- drm(Median ~ Temp, data = Acr_data[Acr_data$Site=="AlWajh",], curveid=Geno, fct = LL.3())
summary(Acr_AlWajh)
plot(Acr_AlWajh)
Acr_AlWajh_genocoeffs_50<-data.frame(ED(Acr_AlWajh, c(50)))
Acr_AlWajh_coeff_mean<-mean(Acr_AlWajh_genocoeffs_50$Estimate)
Acr_AlWajh_coeff_mean
Acr_AlWajh_summary<-data.frame(CI(Acr_AlWajh_genocoeffs_50$Estimate, ci=0.95))
Acr_AlWajh_coeff_lower<-Acr_AlWajh_summary[3,]
Acr_AlWajh_coeff_upper<-Acr_AlWajh_summary[1,]
Acr_Yanbu_pop <- drm(Median ~ Temp, data = Acr_data[Acr_data$Site=="Yanbu",], fct = LL.3())
summary(Acr_Yanbu_pop)
plot(Acr_Yanbu_pop)
Acr_Yanbu <- drm(Median ~ Temp, data = Acr_data[Acr_data$Site=="Yanbu",], curveid=Geno, fct = LL.3())
summary(Acr_Yanbu)
plot(Acr_Yanbu)
Acr_Yanbu_genocoeffs_50<-data.frame(ED(Acr_Yanbu, c(50)))
Acr_Yanbu_coeff_mean<-mean(Acr_Yanbu_genocoeffs_50$Estimate)
Acr_Yanbu_coeff_mean
Acr_Yanbu_summary<-data.frame(CI(Acr_Yanbu_genocoeffs_50$Estimate, ci=0.95))
Acr_Yanbu_coeff_lower<-Acr_Yanbu_summary[3,]
Acr_Yanbu_coeff_upper<-Acr_Yanbu_summary[1,]
Acr_AlFahal_pop <- drm(Median ~ Temp, data = Acr_data[Acr_data$Site=="AlFahal",], fct = LL.3())
summary(Acr_AlFahal_pop)
plot(Acr_AlFahal_pop)
Acr_AlFahal <- drm(Median ~ Temp, data = Acr_data[Acr_data$Site=="AlFahal",], curveid=Geno, fct = LL.3())
summary(Acr_AlFahal)
plot(Acr_AlFahal)
Acr_AlFahal_genocoeffs_50<-data.frame(ED(Acr_AlFahal, c(50)))
Acr_AlFahal_coeff_mean<-mean(Acr_AlFahal_genocoeffs_50$Estimate)
Acr_AlFahal_coeff_mean
Acr_AlFahal_summary<-data.frame(CI(Acr_AlFahal_genocoeffs_50$Estimate, ci=0.95))
Acr_AlFahal_coeff_lower<-Acr_AlFahal_summary[3,]
Acr_AlFahal_coeff_upper<-Acr_AlFahal_summary[1,]
Acr_Geno_ED50s<-Acr_Geno_ED50s %>%
dplyr::rename(AlWajh=X1,
Yanbu=X2,
AlFahal=X3)
Acr_Geno_ED50s <- data.frame(cbind(Acr_AlWajh_genocoeffs_50[,1],
Acr_Yanbu_genocoeffs_50[,1], Acr_AlFahal_genocoeffs_50[,1]))
Acr_Geno_ED50s<-Acr_Geno_ED50s %>%
dplyr::rename(AlWajh=X1,
Yanbu=X2,
AlFahal=X3)
Acr_Geno_ED50s
Acr_Geno_ED50s$Geno<-as.factor(1:nrow(Acr_Geno_ED50s))
str(Acr_Geno_ED50s)
Acr_Geno_ED50s_long<-melt(Acr_GenoED_50s, id="Geno")
Acr_Geno_ED50s_long<-Acr_Geno_ED50s_long %>%
dplyr::rename(Site= variable,
ED50=value)
Acr_Geno_ED50s$Geno<-as.factor(1:nrow(Acr_Geno_ED50s))
str(Acr_Geno_ED50s)
Acr_Geno_ED50s_long<-melt(Acr_GenoED_50s, id="Geno")
Acr_Geno_ED50s_long<-melt(Acr_Geno_ED50s, id="Geno")
Acr_Geno_ED50s_long<-Acr_Geno_ED50s_long %>%
dplyr::rename(Site= variable,
ED50=value)
Acr_Geno_ED50s_long
Acr_ED50_mod<-aov(ED50 ~ Site, Acr_Geno_ED50s_long)
summary(Acr_ED50_mod)
TukeyHSD(Acr_ED50_mod)
Acr_coeff_means<-data.frame(Acr_AlWajh_coeff_mean, Acr_AlFahal_coeff_mean, Acr_Yanbu_coeff_mean)
Acr_coeff_lowers<-data.frame(Acr_AlWajh_coeff_lower, Acr_AlFahal_coeff_lower, Acr_Yanbu_coeff_lower)
Acr_coeff_uppers<-data.frame(Acr_AlWajh_coeff_upper, Acr_AlFahal_coeff_upper, Acr_Yanbu_coeff_upper)
Acr_AlWajh_preddata = data.frame(temp = seq(30,39, length.out = 100))
Acr_AlWajh_pred = as.data.frame(predict(Acr_AlWajh1, newdata = Acr_AlWajh_preddata, interval = 'confidence'))
Acr_AlWajh_preddata = data.frame(Acr_AlWajh_preddata, Median = Acr_AlWajh_pred$Prediction, Lower = Acr_AlWajh_pred$Lower, Upper = Acr_AlWajh_pred$Upper)
Acr_AlFahal_preddata = data.frame(temp = seq(30,39, length.out = 100))
Acr_AlFahal_pred = as.data.frame(predict(Acr_AlFahal1, newdata = Acr_AlFahal_preddata, interval = 'confidence'))
Acr_AlFahal_preddata = data.frame(Acr_AlFahal_preddata, Median = Acr_AlFahal_pred$Prediction, Lower = Acr_AlFahal_pred$Lower, Upper = Acr_AlFahal_pred$Upper)
Acr_Yanbu_preddata = data.frame(temp = seq(30,39, length.out = 100))
Acr_Yanbu_pred = as.data.frame(predict(Acr_Yanbu1, newdata = Acr_Yanbu_preddata, interval = 'confidence'))
Acr_Yanbu_preddata = data.frame(Acr_Yanbu_preddata, Median = Acr_Yanbu_pred$Prediction, Lower = Acr_Yanbu_pred$Lower, Upper = Acr_Yanbu_pred$Upper)
Acr_AlWajh_preddata = data.frame(temp = seq(30,39, length.out = 100))
Acr_AlWajh_pred = as.data.frame(predict(Acr_AlWajh_pop, newdata = Acr_AlWajh_preddata, interval = 'confidence'))
Acr_AlWajh_preddata = data.frame(Acr_AlWajh_preddata, Median = Acr_AlWajh_pred$Prediction, Lower = Acr_AlWajh_pred$Lower, Upper = Acr_AlWajh_pred$Upper)
Acr_AlFahal_preddata = data.frame(temp = seq(30,39, length.out = 100))
Acr_AlFahal_pred = as.data.frame(predict(Acr_AlFahal_pop, newdata = Acr_AlFahal_preddata, interval = 'confidence'))
Acr_AlFahal_preddata = data.frame(Acr_AlFahal_preddata, Median = Acr_AlFahal_pred$Prediction, Lower = Acr_AlFahal_pred$Lower, Upper = Acr_AlFahal_pred$Upper)
Acr_Yanbu_preddata = data.frame(temp = seq(30,39, length.out = 100))
Acr_Yanbu_pred = as.data.frame(predict(Acr_Yanbu_pop, newdata = Acr_Yanbu_preddata, interval = 'confidence'))
Acr_Yanbu_preddata = data.frame(Acr_Yanbu_preddata, Median = Acr_Yanbu_pred$Prediction, Lower = Acr_Yanbu_pred$Lower, Upper = Acr_Yanbu_pred$Upper)
Acr_plot<- ggplot() +
geom_jitter(data = Acr_data, aes(x = Temp, y = Median, color = Site), size = 1, width = 0.25) +
scale_x_continuous(limits=c(29,40), breaks=c(30,32,34,36,38)) +
scale_y_continuous(limits=c(-5, 125), breaks=c(0, 20, 40, 60, 80, 100)) +
geom_line(data = Acr_AlWajh_preddata, aes(x = temp, y = Median), color = 'darkgoldenrod1', show.legend = FALSE) +
geom_ribbon(data = Acr_AlWajh_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkgoldenrod1', linetype=2, alpha = 0.2) +
geom_vline(data = Acr_coeff_means, aes(xintercept = Acr_AlWajh_coeff_mean), color = 'darkgoldenrod1', show.legend = FALSE) +
annotate("rect", xmin=Acr_coeff_lowers$Acr_AlWajh_coeff_lower, xmax=Acr_coeff_uppers$Acr_AlWajh_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkgoldenrod1',  alpha = 0.1) +
geom_text(data = Acr_coeff_means, aes(label = Acr_AlWajh_coeff_mean), x = 31, y = 0.25, show.legend = FALSE, color = 'darkgoldenrod1') +
geom_line(data = Acr_Yanbu_preddata, aes(x = temp, y = Median), color = 'darkorange1', show.legend = FALSE) +
geom_ribbon(data = Acr_Yanbu_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkorange1', linetype=2, alpha = 0.2) +
geom_vline(data = Acr_coeff_means, aes(xintercept = Acr_Yanbu_coeff_mean), color = 'darkorange1', show.legend = FALSE) +
annotate("rect", xmin=Acr_coeff_lowers$Acr_Yanbu_coeff_lower, xmax=Acr_coeff_uppers$Acr_Yanbu_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkorange1',  alpha = 0.1) +
geom_text(data = Acr_coeff_means, aes(label = Acr_Yanbu_coeff_mean), x = 31, y = 0.20, show.legend = FALSE, color = 'darkorange1') +
geom_line(data = Acr_AlFahal_preddata, aes(x = temp, y = Median), color = 'red3', show.legend = FALSE) +
geom_ribbon(data = Acr_AlFahal_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'red3', linetype=2, alpha = 0.2) +
geom_vline(data = Acr_coeff_means, aes(xintercept = Acr_AlFahal_coeff_mean), color = 'red3', show.legend = FALSE) +
annotate("rect", xmin=Acr_coeff_lowers$Acr_AlFahal_coeff_lower, xmax=Acr_coeff_uppers$Acr_AlFahal_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'red3',  alpha = 0.1) +
geom_text(data = Acr_coeff_means, aes(label = Acr_AlFahal_coeff_mean), x = 31, y = 0.15, show.legend = FALSE, color = 'red3') +
ggtitle("Acropora") +
scale_color_manual(values=c("royalblue2", "darkgoldenrod1", "darkorange1", "red3")) +
ylab("Percent pigmentation") +
xlab("Temperature (°C)") +
theme_bw()
Acr_plot
Acr_data$Temp<-as.character(Acr_data$Temp)
Acr_data$Temp<-as.numeric(Acr_data$Temp)
levels(Acr_data$Site)
Acr_data$Site = factor(Acr_data$Site,levels(Acr_data$Site)[c(4,3,6,1)])
levels(Acr_data$Site)
Acr_plot<- ggplot() +
geom_jitter(data = Acr_data, aes(x = Temp, y = Median, color = Site), size = 1, width = 0.25) +
scale_x_continuous(limits=c(29,40), breaks=c(30,32,34,36,38)) +
scale_y_continuous(limits=c(-5, 125), breaks=c(0, 20, 40, 60, 80, 100)) +
geom_line(data = Acr_AlWajh_preddata, aes(x = temp, y = Median), color = 'darkgoldenrod1', show.legend = FALSE) +
geom_ribbon(data = Acr_AlWajh_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkgoldenrod1', linetype=2, alpha = 0.2) +
geom_vline(data = Acr_coeff_means, aes(xintercept = Acr_AlWajh_coeff_mean), color = 'darkgoldenrod1', show.legend = FALSE) +
annotate("rect", xmin=Acr_coeff_lowers$Acr_AlWajh_coeff_lower, xmax=Acr_coeff_uppers$Acr_AlWajh_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkgoldenrod1',  alpha = 0.1) +
geom_text(data = Acr_coeff_means, aes(label = Acr_AlWajh_coeff_mean), x = 31, y = 0.25, show.legend = FALSE, color = 'darkgoldenrod1') +
geom_line(data = Acr_Yanbu_preddata, aes(x = temp, y = Median), color = 'darkorange1', show.legend = FALSE) +
geom_ribbon(data = Acr_Yanbu_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkorange1', linetype=2, alpha = 0.2) +
geom_vline(data = Acr_coeff_means, aes(xintercept = Acr_Yanbu_coeff_mean), color = 'darkorange1', show.legend = FALSE) +
annotate("rect", xmin=Acr_coeff_lowers$Acr_Yanbu_coeff_lower, xmax=Acr_coeff_uppers$Acr_Yanbu_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkorange1',  alpha = 0.1) +
geom_text(data = Acr_coeff_means, aes(label = Acr_Yanbu_coeff_mean), x = 31, y = 0.20, show.legend = FALSE, color = 'darkorange1') +
geom_line(data = Acr_AlFahal_preddata, aes(x = temp, y = Median), color = 'red3', show.legend = FALSE) +
geom_ribbon(data = Acr_AlFahal_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'red3', linetype=2, alpha = 0.2) +
geom_vline(data = Acr_coeff_means, aes(xintercept = Acr_AlFahal_coeff_mean), color = 'red3', show.legend = FALSE) +
annotate("rect", xmin=Acr_coeff_lowers$Acr_AlFahal_coeff_lower, xmax=Acr_coeff_uppers$Acr_AlFahal_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'red3',  alpha = 0.1) +
geom_text(data = Acr_coeff_means, aes(label = Acr_AlFahal_coeff_mean), x = 31, y = 0.15, show.legend = FALSE, color = 'red3') +
ggtitle("Acropora") +
scale_color_manual(values=c("royalblue2", "darkgoldenrod1", "darkorange1", "red3")) +
ylab("Percent pigmentation") +
xlab("Temperature (°C)") +
theme_bw()
Acr_plot
Acr_plot<- ggplot() +
geom_jitter(data = Acr_data, aes(x = Temp, y = Median, color = Site), size = 1, width = 0.25) +
scale_x_continuous(limits=c(29,40), breaks=c(30,32,34,36,38)) +
scale_y_continuous(limits=c(-5, 125), breaks=c(0, 20, 40, 60, 80, 100)) +
geom_line(data = Acr_AlWajh_preddata, aes(x = temp, y = Median), color = 'darkgoldenrod1', show.legend = FALSE) +
geom_ribbon(data = Acr_AlWajh_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkgoldenrod1', linetype=2, alpha = 0.2) +
geom_vline(data = Acr_coeff_means, aes(xintercept = Acr_AlWajh_coeff_mean), color = 'darkgoldenrod1', show.legend = FALSE) +
annotate("rect", xmin=Acr_coeff_lowers$Acr_AlWajh_coeff_lower, xmax=Acr_coeff_uppers$Acr_AlWajh_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkgoldenrod1',  alpha = 0.1) +
geom_text(data = Acr_coeff_means, aes(label=round(Acr_AlWajh_coeff_mean, digits = 2)), x = 31, y = 25, show.legend = FALSE, color = 'darkgoldenrod1') +
geom_line(data = Acr_Yanbu_preddata, aes(x = temp, y = Median), color = 'darkorange1', show.legend = FALSE) +
geom_ribbon(data = Acr_Yanbu_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkorange1', linetype=2, alpha = 0.2) +
geom_vline(data = Acr_coeff_means, aes(xintercept = Acr_Yanbu_coeff_mean), color = 'darkorange1', show.legend = FALSE) +
annotate("rect", xmin=Acr_coeff_lowers$Acr_Yanbu_coeff_lower, xmax=Acr_coeff_uppers$Acr_Yanbu_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkorange1',  alpha = 0.1) +
geom_text(data = Acr_coeff_means, aes(label=round(Acr_Yanbu_coeff_mean, digits = 2)), x = 31, y = 20, show.legend = FALSE, color = 'darkorange1') +
geom_line(data = Acr_AlFahal_preddata, aes(x = temp, y = Median), color = 'red3', show.legend = FALSE) +
geom_ribbon(data = Acr_AlFahal_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'red3', linetype=2, alpha = 0.2) +
geom_vline(data = Acr_coeff_means, aes(xintercept = Acr_AlFahal_coeff_mean), color = 'red3', show.legend = FALSE) +
annotate("rect", xmin=Acr_coeff_lowers$Acr_AlFahal_coeff_lower, xmax=Acr_coeff_uppers$Acr_AlFahal_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'red3',  alpha = 0.1) +
geom_text(data = Acr_coeff_means, aes(label=round(Acr_AlFahal_coeff_mean, digits = 2)), x = 31, y = 15, show.legend = FALSE, color = 'red3') +
ggtitle("Acropora") +
scale_color_manual(values=c("royalblue2", "darkgoldenrod1", "darkorange1", "red3")) +
ylab("Percent pigmentation") +
xlab("Temperature (°C)") +
theme_bw()
Acr_plot
Poc_Eilat_pop <- drm(Median ~ Temp, data = Poc_data[Poc_data$Site=="Eilat",], fct = LL.3())
summary(Poc_Eilat_pop)
plot(Poc_Eilat_pop)
Poc_Eilat <- drm(Median ~ Temp, data = Poc_data[Poc_data$Site=="Eilat",], curveid=Geno, fct = LL.3())
summary(Poc_Eilat)
plot(Poc_Eilat)
Poc_Eilat_genocoeffs_50<-data.frame(ED(Poc_Eilat, c(50)))
Poc_Eilat_coeff_mean<-mean(Poc_Eilat_genocoeffs_50$Estimate)
Poc_Eilat_coeff_mean
Poc_Eilat_summary<-data.frame(CI(Poc_Eilat_genocoeffs_50$Estimate, ci=0.95))
Poc_Eilat_coeff_lower<-Poc_Eilat_summary[3,]
Poc_Eilat_coeff_upper<-Poc_Eilat_summary[1,]
Poc_AlWajh_pop <- drm(Median ~ Temp, data = Poc_data[Poc_data$Site=="AlWajh",], fct = LL.3())
summary(Poc_AlWajh_pop)
plot(Poc_AlWajh_pop)
Poc_AlWajh <- drm(Median ~ Temp, data = Poc_data[Poc_data$Site=="AlWajh",], curveid=Geno, fct = LL.3())
summary(Poc_AlWajh)
plot(Poc_AlWajh)
Poc_AlWajh_genocoeffs_50<-data.frame(ED(Poc_AlWajh, c(50)))
Poc_AlWajh_coeff_mean<-mean(Poc_AlWajh_genocoeffs_50$Estimate)
Poc_AlWajh_coeff_mean
Poc_AlWajh_summary<-data.frame(CI(Poc_AlWajh_genocoeffs_50$Estimate, ci=0.95))
Poc_AlWajh_coeff_lower<-Poc_AlWajh_summary[3,]
Poc_AlWajh_coeff_upper<-Poc_AlWajh_summary[1,]
Poc_Yanbu_pop <- drm(Median ~ Temp, data = Poc_data[Poc_data$Site=="Yanbu",], fct = LL.3())
summary(Poc_Yanbu_pop)
plot(Poc_Yanbu_pop)
Poc_Yanbu <- drm(Median ~ Temp, data = Poc_data[Poc_data$Site=="Yanbu",], curveid=Geno, fct = LL.3())
summary(Poc_Yanbu)
plot(Poc_Yanbu)
Poc_Yanbu_genocoeffs_50<-data.frame(ED(Poc_Yanbu, c(50)))
Poc_Yanbu_coeff_mean<-mean(Poc_Yanbu_genocoeffs_50$Estimate)
Poc_Yanbu_coeff_mean
Poc_Yanbu_summary<-data.frame(CI(Poc_Yanbu_genocoeffs_50$Estimate, ci=0.95))
Poc_Yanbu_coeff_lower<-Poc_Yanbu_summary[3,]
Poc_Yanbu_coeff_upper<-Poc_Yanbu_summary[1,]
Poc_AlFahal_pop <- drm(Median ~ Temp, data = Poc_data[Poc_data$Site=="AlFahal",], fct = LL.3())
summary(Poc_AlFahal_pop)
plot(Poc_AlFahal_pop)
Poc_AlFahal <- drm(Median ~ Temp, data = Poc_data[Poc_data$Site=="AlFahal",], curveid=Geno, fct = LL.3())
summary(Poc_AlFahal)
plot(Poc_AlFahal)
Poc_AlFahal_genocoeffs_50<-data.frame(ED(Poc_AlFahal, c(50)))
Poc_AlFahal_coeff_mean<-mean(Poc_AlFahal_genocoeffs_50$Estimate)
Poc_AlFahal_coeff_mean
Poc_AlFahal_summary<-data.frame(CI(Poc_AlFahal_genocoeffs_50$Estimate, ci=0.95))
Poc_AlFahal_coeff_lower<-Poc_AlFahal_summary[3,]
Poc_AlFahal_coeff_upper<-Poc_AlFahal_summary[1,]
Poc_Obock_pop <- drm(Median ~ Temp, data = Poc_data[Poc_data$Site=="Obock",], fct = LL.3())
summary(Poc_Obock_pop)
plot(Poc_Obock_pop)
Poc_Obock <- drm(Median ~ Temp, data = Poc_data[Poc_data$Site=="Obock",], curveid=Geno, fct = LL.3())
summary(Poc_Obock)
plot(Poc_Obock)
Poc_Obock_genocoeffs_50<-data.frame(ED(Poc_Obock, c(50)))
Poc_Obock_coeff_mean<-mean(Poc_Obock_genocoeffs_50$Estimate)
Poc_Obock_coeff_mean
Poc_Obock_summary<-data.frame(CI(Poc_Obock_genocoeffs_50$Estimate, ci=0.95))
Poc_Obock_coeff_lower<-Poc_Obock_summary[3,]
Poc_Obock_coeff_upper<-Poc_Obock_summary[1,]
Poc_Geno_ED50s <- data.frame(cbind(Poc_Obock_genocoeffs_50[,1],Poc_Eilat_genocoeffs_50[,1],Poc_AlWajh_genocoeffs_50[,1],
Poc_Yanbu_genocoeffs_50[,1], Poc_AlFahal_genocoeffs_50[,1]))
Poc_GenoED_50s<-Poc_Geno_ED50s %>%
dplyr::rename(Obock= X1,
Eilat=X2,
AlWajh=X3,
Yanbu=X4,
AlFahal=X5)
Poc_Obock_genocoeffs_50
Poc_Eilat_genocoeffs_50
Poc_AlWajh_genocoeffs_50
Poc_Yanbu_genocoeffs_50
Poc_AlFahal_genocoeffs_50
Poc_AlFahal <- drm(Median ~ Temp, data = Poc_data[Poc_data$Site=="AlFahal",], curveid=Geno, fct = LL.3())
summary(Poc_AlFahal)
Por_Geno_ED50s<-merge(Por_Obock_genocoeffs_50[,1],Poc_Eilat_genocoeffs_50[,1], by=0, all=TRUE)
Por_Geno_ED50s<-Por_Geno_ED50s %>%
dplyr::rename(Obock= x,
Eilat=y)
View(Poc_Geno_ED50s)
View(Poc_Geno_ED50s)
Poc_Geno_ED50s<-merge(Poc_Obock_genocoeffs_50[,1],Poc_Eilat_genocoeffs_50[,1], by=0, all=TRUE)
Poc_Geno_ED50s<-Poc_Geno_ED50s %>%
dplyr::rename(Obock= x,
Eilat=y)
View(Poc_Geno_ED50s)
Poc_Geno_ED50s<-merge(Poc_Geno_ED50s[,2:3],Poc_AlWajh_genocoeffs_50[,1], by=0, all=TRUE)
Poc_Geno_ED50s<-merge(Poc_Geno_ED50s[,2:4],Poc_Yanbu_genocoeffs_50[,1], by=0, all=TRUE)
Poc_Geno_ED50s<-merge(Poc_Geno_ED50s[,2:5],Poc_AlFahal_genocoeffs_50[,1], by=0, all=TRUE)
Poc_Geno_ED50s<-Poc_Geno_ED50s %>%
dplyr::rename(Obock= Obock,
AlQunfudhah=AlQunfudhah,
AlWajh=y.x,
Yanbu=y.y,
AlFahal=y)
Poc_Geno_ED50s<-Poc_Geno_ED50s %>%
dplyr::rename(Obock= Obock,
Eilat=Eilat,
AlWajh=y.x,
Yanbu=y.y,
AlFahal=y)
Poc_Geno_ED50s<-Poc_Geno_ED50s[,2:6]
GenoED_50s$Geno<-as.factor(1:nrow(GenoED_50s))
Poc_Geno_ED50s$Geno<-as.factor(1:nrow(Poc_Geno_ED50s))
str(Poc_Geno_ED50s)
Poc_Geno_ED50s_long<-melt(Poc_Geno_ED50s, id="Geno")
Poc_Geno_ED50s_long<-Poc_Geno_ED50s_long %>%
dplyr::rename(Site= variable,
ED50=value)
Poc_ED50_mod<-aov(ED50 ~ Site, Poc_Geno_ED50s_long)
summary(Poc_ED50_mod)
TukeyHSD(Poc_ED50_mod)
Poc_coeff_means<-data.frame(Poc_AlWajh_coeff_mean, Poc_Eilat_coeff_mean, Poc_AlFahal_coeff_mean, Poc_Obock_coeff_mean, Poc_Yanbu_coeff_mean)
Poc_coeff_lowers<-data.frame(Poc_AlWajh_coeff_lower, Poc_Eilat_coeff_lower, Poc_AlFahal_coeff_lower, Poc_Obock_coeff_lower, Poc_Yanbu_coeff_lower)
Poc_coeff_uppers<-data.frame(Poc_AlWajh_coeff_upper, Poc_Eilat_coeff_upper, Poc_AlFahal_coeff_upper, Poc_Obock_coeff_upper, Poc_Yanbu_coeff_upper)
Poc_AlWajh_preddata = data.frame(temp = seq(30,39, length.out = 100))
Poc_AlWajh_pred = as.data.frame(predict(Poc_AlWajh_pop, newdata = Poc_AlWajh_preddata, interval = 'confidence'))
Poc_AlWajh_preddata = data.frame(Poc_AlWajh_preddata, Median = Poc_AlWajh_pred$Prediction, Lower = Poc_AlWajh_pred$Lower, Upper = Poc_AlWajh_pred$Upper)
Poc_Eilat_preddata = data.frame(temp = seq(30,39, length.out = 100))
Poc_Eilat_pred = as.data.frame(predict(Poc_Eilat_pop, newdata = Poc_Eilat_preddata, interval = 'confidence'))
Poc_Eilat_preddata = data.frame(Poc_Eilat_preddata, Median = Poc_Eilat_pred$Prediction, Lower = Poc_Eilat_pred$Lower, Upper = Poc_Eilat_pred$Upper)
Poc_AlFahal_preddata = data.frame(temp = seq(30,39, length.out = 100))
Poc_AlFahal_pred = as.data.frame(predict(Poc_AlFahal_pop, newdata = Poc_AlFahal_preddata, interval = 'confidence'))
Poc_AlFahal_preddata = data.frame(Poc_AlFahal_preddata, Median = Poc_AlFahal_pred$Prediction, Lower = Poc_AlFahal_pred$Lower, Upper = Poc_AlFahal_pred$Upper)
Poc_Obock_preddata = data.frame(temp = seq(30,39, length.out = 100))
Poc_Obock_pred = as.data.frame(predict(Poc_Obock_pop, newdata = Poc_Obock_preddata, interval = 'confidence'))
Poc_Obock_preddata = data.frame(Poc_Obock_preddata, Median = Poc_Obock_pred$Prediction, Lower = Poc_Obock_pred$Lower, Upper = Poc_Obock_pred$Upper)
Poc_Yanbu_preddata = data.frame(temp = seq(30,39, length.out = 100))
Poc_Yanbu_pred = as.data.frame(predict(Poc_Yanbu_pop, newdata = Poc_Yanbu_preddata, interval = 'confidence'))
Poc_Yanbu_preddata = data.frame(Poc_Yanbu_preddata, Median = Poc_Yanbu_pred$Prediction, Lower = Poc_Yanbu_pred$Lower, Upper = Poc_Yanbu_pred$Upper)
Poc_data$Temp<-as.character(Poc_data$Temp)
Poc_data$Temp<-as.numeric(Poc_data$Temp)
Poc_plot<- ggplot() +
geom_jitter(data = Poc_data, aes(x = Temp, y = Median, color = Site), size = 1, width = 0.25) +
scale_x_continuous(limits=c(29,40), breaks=c(30,32,34,36,38)) +
scale_y_continuous(limits=c(-60, 151), breaks=c(0, 20, 40, 60, 80, 100)) +
geom_line(data = Poc_Eilat_preddata, aes(x = temp, y = Median), color = 'royalblue2', show.legend = FALSE) +
geom_ribbon(data = Poc_Eilat_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'royalblue2', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_Eilat_coeff_mean), color = 'royalblue2', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_Eilat_coeff_lower, xmax=Poc_coeff_uppers$Poc_Eilat_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'royalblue2',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label = Poc_Eilat_coeff_mean), x = 31, y = 0.3, show.legend = FALSE, color = 'royalblue2') +
geom_line(data = Poc_AlWajh_preddata, aes(x = temp, y = Median), color = 'darkgoldenrod1', show.legend = FALSE) +
geom_ribbon(data = Poc_AlWajh_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkgoldenrod1', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_AlWajh_coeff_mean), color = 'darkgoldenrod1', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_AlWajh_coeff_lower, xmax=Poc_coeff_uppers$Poc_AlWajh_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkgoldenrod1',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label = Poc_AlWajh_coeff_mean), x = 31, y = 0.25, show.legend = FALSE, color = 'darkgoldenrod1') +
geom_line(data = Poc_Yanbu_preddata, aes(x = temp, y = Median), color = 'darkorange1', show.legend = FALSE) +
geom_ribbon(data = Poc_Yanbu_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkorange1', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_Yanbu_coeff_mean), color = 'darkorange1', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_Yanbu_coeff_lower, xmax=Poc_coeff_uppers$Poc_Yanbu_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkorange1',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label = Poc_Yanbu_coeff_mean), x = 31, y = 0.20, show.legend = FALSE, color = 'darkorange1') +
geom_line(data = Poc_AlFahal_preddata, aes(x = temp, y = Median), color = 'red3', show.legend = FALSE) +
geom_ribbon(data = Poc_AlFahal_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'red3', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_AlFahal_coeff_mean), color = 'red3', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_AlFahal_coeff_lower, xmax=Poc_coeff_uppers$Poc_AlFahal_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'red3',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label = Poc_AlFahal_coeff_mean), x = 31, y = 0.15, show.legend = FALSE, color = 'red3') +
geom_line(data = Poc_Obock_preddata, aes(x = temp, y = Median), color = 'springgreen1', show.legend = FALSE) +
geom_ribbon(data = Poc_Obock_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'springgreen1', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_Obock_coeff_mean), color = 'springgreen1', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_Obock_coeff_lower, xmax=Poc_coeff_uppers$Poc_Obock_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'springgreen1',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label = Poc_Obock_coeff_mean), x = 31, y = 0.05, show.legend = FALSE, color = 'springgreen1') +
ggtitle("Pocillopora") +
scale_color_manual(values=c("royalblue2", "darkgoldenrod1", "darkorange1", "red3", "springgreen1")) +
ylab("Percent pigmentation") +
xlab("Temperature (°C)") +
theme_bw()
Poc_plot
Poc_plot<- ggplot() +
geom_jitter(data = Poc_data, aes(x = Temp, y = Median, color = Site), size = 1, width = 0.25) +
scale_x_continuous(limits=c(29,40), breaks=c(30,32,34,36,38)) +
scale_y_continuous(limits=c(-60, 151), breaks=c(0, 20, 40, 60, 80, 100)) +
geom_line(data = Poc_Eilat_preddata, aes(x = temp, y = Median), color = 'royalblue2', show.legend = FALSE) +
geom_ribbon(data = Poc_Eilat_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'royalblue2', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_Eilat_coeff_mean), color = 'royalblue2', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_Eilat_coeff_lower, xmax=Poc_coeff_uppers$Poc_Eilat_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'royalblue2',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_Eilat_coeff_mean, digits = 2)), x = 31, y = 30, show.legend = FALSE, color = 'royalblue2') +
geom_line(data = Poc_AlWajh_preddata, aes(x = temp, y = Median), color = 'darkgoldenrod1', show.legend = FALSE) +
geom_ribbon(data = Poc_AlWajh_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkgoldenrod1', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_AlWajh_coeff_mean), color = 'darkgoldenrod1', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_AlWajh_coeff_lower, xmax=Poc_coeff_uppers$Poc_AlWajh_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkgoldenrod1',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_AlWajh_coeff_mean, digits = 2)), x = 31, y = 25, show.legend = FALSE, color = 'darkgoldenrod1') +
geom_line(data = Poc_Yanbu_preddata, aes(x = temp, y = Median), color = 'darkorange1', show.legend = FALSE) +
geom_ribbon(data = Poc_Yanbu_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkorange1', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_Yanbu_coeff_mean), color = 'darkorange1', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_Yanbu_coeff_lower, xmax=Poc_coeff_uppers$Poc_Yanbu_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkorange1',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_Yanbu_coeff_mean, digits = 2)), x = 31, y = 20, show.legend = FALSE, color = 'darkorange1') +
geom_line(data = Poc_AlFahal_preddata, aes(x = temp, y = Median), color = 'red3', show.legend = FALSE) +
geom_ribbon(data = Poc_AlFahal_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'red3', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_AlFahal_coeff_mean), color = 'red3', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_AlFahal_coeff_lower, xmax=Poc_coeff_uppers$Poc_AlFahal_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'red3',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_AlFahal_coeff_mean, digits = 2)), x = 31, y = 15, show.legend = FALSE, color = 'red3') +
geom_line(data = Poc_Obock_preddata, aes(x = temp, y = Median), color = 'springgreen1', show.legend = FALSE) +
geom_ribbon(data = Poc_Obock_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'springgreen1', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_Obock_coeff_mean), color = 'springgreen1', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_Obock_coeff_lower, xmax=Poc_coeff_uppers$Poc_Obock_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'springgreen1',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_Obock_coeff_mean, digits = 2)), x = 31, y = 10, show.legend = FALSE, color = 'springgreen1') +
ggtitle("Pocillopora") +
scale_color_manual(values=c("royalblue2", "darkgoldenrod1", "darkorange1", "red3", "springgreen1")) +
ylab("Percent pigmentation") +
xlab("Temperature (°C)") +
theme_bw()
Poc_plot
levels(Poc_data$Site)
Poc_data$Site = factor(Poc_data$Site,levels(Poc_data$Site)[c(4,3,6,1,5)])
Poc_plot<- ggplot() +
geom_jitter(data = Poc_data, aes(x = Temp, y = Median, color = Site), size = 1, width = 0.25) +
scale_x_continuous(limits=c(29,40), breaks=c(30,32,34,36,38)) +
scale_y_continuous(limits=c(-60, 151), breaks=c(0, 20, 40, 60, 80, 100)) +
geom_line(data = Poc_Eilat_preddata, aes(x = temp, y = Median), color = 'royalblue2', show.legend = FALSE) +
geom_ribbon(data = Poc_Eilat_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'royalblue2', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_Eilat_coeff_mean), color = 'royalblue2', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_Eilat_coeff_lower, xmax=Poc_coeff_uppers$Poc_Eilat_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'royalblue2',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_Eilat_coeff_mean, digits = 2)), x = 31, y = 30, show.legend = FALSE, color = 'royalblue2') +
geom_line(data = Poc_AlWajh_preddata, aes(x = temp, y = Median), color = 'darkgoldenrod1', show.legend = FALSE) +
geom_ribbon(data = Poc_AlWajh_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkgoldenrod1', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_AlWajh_coeff_mean), color = 'darkgoldenrod1', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_AlWajh_coeff_lower, xmax=Poc_coeff_uppers$Poc_AlWajh_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkgoldenrod1',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_AlWajh_coeff_mean, digits = 2)), x = 31, y = 25, show.legend = FALSE, color = 'darkgoldenrod1') +
geom_line(data = Poc_Yanbu_preddata, aes(x = temp, y = Median), color = 'darkorange1', show.legend = FALSE) +
geom_ribbon(data = Poc_Yanbu_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkorange1', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_Yanbu_coeff_mean), color = 'darkorange1', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_Yanbu_coeff_lower, xmax=Poc_coeff_uppers$Poc_Yanbu_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkorange1',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_Yanbu_coeff_mean, digits = 2)), x = 31, y = 20, show.legend = FALSE, color = 'darkorange1') +
geom_line(data = Poc_AlFahal_preddata, aes(x = temp, y = Median), color = 'red3', show.legend = FALSE) +
geom_ribbon(data = Poc_AlFahal_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'red3', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_AlFahal_coeff_mean), color = 'red3', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_AlFahal_coeff_lower, xmax=Poc_coeff_uppers$Poc_AlFahal_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'red3',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_AlFahal_coeff_mean, digits = 2)), x = 31, y = 15, show.legend = FALSE, color = 'red3') +
geom_line(data = Poc_Obock_preddata, aes(x = temp, y = Median), color = 'springgreen1', show.legend = FALSE) +
geom_ribbon(data = Poc_Obock_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'springgreen1', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_Obock_coeff_mean), color = 'springgreen1', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_Obock_coeff_lower, xmax=Poc_coeff_uppers$Poc_Obock_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'springgreen1',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_Obock_coeff_mean, digits = 2)), x = 31, y = 10, show.legend = FALSE, color = 'springgreen1') +
ggtitle("P. verrucosa") +
scale_color_manual(values=c("royalblue2", "darkgoldenrod1", "darkorange1", "red3", "springgreen1")) +
ylab("Percent pigmentation") +
xlab("Temperature (°C)") +
theme_bw()
Poc_plot
Poc_plot<- ggplot() +
geom_jitter(data = Poc_data, aes(x = Temp, y = Median, color = Site), size = 1, width = 0.25) +
scale_x_continuous(limits=c(29,40), breaks=c(30,32,34,36,38)) +
scale_y_continuous(limits=c(-60, 151), breaks=c(0, 20, 40, 60, 80, 100)) +
geom_line(data = Poc_Eilat_preddata, aes(x = temp, y = Median), color = 'royalblue2', show.legend = FALSE) +
geom_ribbon(data = Poc_Eilat_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'royalblue2', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_Eilat_coeff_mean), color = 'royalblue2', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_Eilat_coeff_lower, xmax=Poc_coeff_uppers$Poc_Eilat_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'royalblue2',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_Eilat_coeff_mean, digits = 2)), x = 31, y = 50, show.legend = FALSE, color = 'royalblue2') +
geom_line(data = Poc_AlWajh_preddata, aes(x = temp, y = Median), color = 'darkgoldenrod1', show.legend = FALSE) +
geom_ribbon(data = Poc_AlWajh_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkgoldenrod1', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_AlWajh_coeff_mean), color = 'darkgoldenrod1', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_AlWajh_coeff_lower, xmax=Poc_coeff_uppers$Poc_AlWajh_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkgoldenrod1',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_AlWajh_coeff_mean, digits = 2)), x = 31, y = 40, show.legend = FALSE, color = 'darkgoldenrod1') +
geom_line(data = Poc_Yanbu_preddata, aes(x = temp, y = Median), color = 'darkorange1', show.legend = FALSE) +
geom_ribbon(data = Poc_Yanbu_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkorange1', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_Yanbu_coeff_mean), color = 'darkorange1', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_Yanbu_coeff_lower, xmax=Poc_coeff_uppers$Poc_Yanbu_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkorange1',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_Yanbu_coeff_mean, digits = 2)), x = 31, y = 30, show.legend = FALSE, color = 'darkorange1') +
geom_line(data = Poc_AlFahal_preddata, aes(x = temp, y = Median), color = 'red3', show.legend = FALSE) +
geom_ribbon(data = Poc_AlFahal_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'red3', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_AlFahal_coeff_mean), color = 'red3', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_AlFahal_coeff_lower, xmax=Poc_coeff_uppers$Poc_AlFahal_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'red3',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_AlFahal_coeff_mean, digits = 2)), x = 31, y = 20, show.legend = FALSE, color = 'red3') +
geom_line(data = Poc_Obock_preddata, aes(x = temp, y = Median), color = 'springgreen1', show.legend = FALSE) +
geom_ribbon(data = Poc_Obock_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'springgreen1', linetype=2, alpha = 0.2) +
geom_vline(data = Poc_coeff_means, aes(xintercept = Poc_Obock_coeff_mean), color = 'springgreen1', show.legend = FALSE) +
annotate("rect", xmin=Poc_coeff_lowers$Poc_Obock_coeff_lower, xmax=Poc_coeff_uppers$Poc_Obock_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'springgreen1',  alpha = 0.1) +
geom_text(data = Poc_coeff_means, aes(label=round(Poc_Obock_coeff_mean, digits = 2)), x = 31, y = 10, show.legend = FALSE, color = 'springgreen1') +
ggtitle("P. verrucosa") +
scale_color_manual(values=c("royalblue2", "darkgoldenrod1", "darkorange1", "red3", "springgreen1")) +
ylab("Percent pigmentation") +
xlab("Temperature (°C)") +
theme_bw()
Poc_plot
levels(Sty_data$Site)
levels(Por_data$Site)
Por_data$Site = factor(Por_data$Site,levels(Por_data$Site)[c(3,6,1,2,5)])
Por_plot<- ggplot() +
geom_jitter(data = Por_data, aes(x = Temp, y = Median, color = Site), size = 1, width = 0.25) +
scale_x_continuous(limits=c(29,40), breaks=c(30,32,34,36,38)) +
scale_y_continuous(limits=c(-5, 125), breaks=c(0, 20, 40, 60, 80, 100)) +
geom_line(data = Por_AlQunfudhah_preddata, aes(x = temp, y = Median), color = 'darkorchid4', show.legend = FALSE) +
geom_ribbon(data = Por_AlQunfudhah_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkorchid4', linetype=2, alpha = 0.2) +
geom_vline(data = Por_coeff_means, aes(xintercept = Por_AlQunfudhah_coeff_mean), color = 'darkorchid4', show.legend = FALSE) +
annotate("rect", xmin=Por_coeff_lowers$Por_AlQunfudhah_coeff_lower, xmax=Por_coeff_uppers$Por_AlQunfudhah_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkorchid4',  alpha = 0.1) +
geom_text(data = Por_coeff_means, aes(label=round(Por_AlQunfudhah_coeff_mean, digits = 2)), x = 31, y = 40, show.legend = FALSE, color = 'darkorchid4') +
geom_line(data = Por_AlWajh_preddata, aes(x = temp, y = Median), color = 'darkgoldenrod1', show.legend = FALSE) +
geom_ribbon(data = Por_AlWajh_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkgoldenrod1', linetype=2, alpha = 0.2) +
geom_vline(data = Por_coeff_means, aes(xintercept = Por_AlWajh_coeff_mean), color = 'darkgoldenrod1', show.legend = FALSE) +
annotate("rect", xmin=Por_coeff_lowers$Por_AlWajh_coeff_lower, xmax=Por_coeff_uppers$Por_AlWajh_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkgoldenrod1',  alpha = 0.1) +
geom_text(data = Por_coeff_means, aes(label=round(Por_AlWajh_coeff_mean, digits = 2)), x = 31, y = 30, show.legend = FALSE, color = 'darkgoldenrod1') +
geom_line(data = Por_Yanbu_preddata, aes(x = temp, y = Median), color = 'darkorange1', show.legend = FALSE) +
geom_ribbon(data = Por_Yanbu_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'darkorange1', linetype=2, alpha = 0.2) +
geom_vline(data = Por_coeff_means, aes(xintercept = Por_Yanbu_coeff_mean), color = 'darkorange1', show.legend = FALSE) +
annotate("rect", xmin=Por_coeff_lowers$Por_Yanbu_coeff_lower, xmax=Por_coeff_uppers$Por_Yanbu_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'darkorange1',  alpha = 0.1) +
geom_text(data = Por_coeff_means, aes(label=round(Por_Yanbu_coeff_mean, digits = 2)), x = 31, y = 20, show.legend = FALSE, color = 'darkorange1') +
geom_line(data = Por_AlFahal_preddata, aes(x = temp, y = Median), color = 'red3', show.legend = FALSE) +
geom_ribbon(data = Por_AlFahal_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'red3', linetype=2, alpha = 0.2) +
geom_vline(data = Por_coeff_means, aes(xintercept = Por_AlFahal_coeff_mean), color = 'red3', show.legend = FALSE) +
annotate("rect", xmin=Por_coeff_lowers$Por_AlFahal_coeff_lower, xmax=Por_coeff_uppers$Por_AlFahal_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'red3',  alpha = 0.1) +
geom_text(data = Por_coeff_means, aes(label=round(Por_AlFahal_coeff_mean, digits = 2)), x = 31, y = 10, show.legend = FALSE, color = 'red3') +
geom_line(data = Por_Obock_preddata, aes(x = temp, y = Median), color = 'springgreen1', show.legend = FALSE) +
geom_ribbon(data = Por_Obock_preddata, aes(x = temp, ymin=Lower, ymax=Upper), color = 'springgreen1', linetype=2, alpha = 0.2) +
geom_vline(data = Por_coeff_means, aes(xintercept = Por_Obock_coeff_mean), color = 'springgreen1', show.legend = FALSE) +
annotate("rect", xmin=Por_coeff_lowers$Por_Obock_coeff_lower, xmax=Por_coeff_uppers$Por_Obock_coeff_upper, ymin=-Inf, ymax=Inf, fill= 'springgreen1',  alpha = 0.1) +
geom_text(data = Por_coeff_means, aes(label=round(Por_Obock_coeff_mean, digits = 2)), x = 31, y = 0, show.legend = FALSE, color = 'springgreen1') +
ggtitle("P. lobata") +
scale_color_manual(values=c("darkgoldenrod1", "darkorange1", "red3", "darkorchid4", "springgreen1")) +
ylab("Percent pigmentation") +
xlab("Temperature (°C)") +
theme_bw()
Por_plot
